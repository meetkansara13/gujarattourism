{% extends "custom_admin/base.html" %}
{% load static %}

{% block content %}

<style>

/* GLOBAL FONT */
body {
    font-family: "Poppins", sans-serif;
}

/* CARD MAIN WRAPPER */
.admin-wrapper {
    background: rgba(255, 255, 255, 0.90);
    backdrop-filter: blur(6px);
    border-radius: 20px;
    padding: 30px;
    margin-top: 40px;
    box-shadow: 0 6px 30px rgba(0,0,0,0.15);
}

/* TITLE */
.admin-title {
    text-align: center;
    font-size: 30px;
    font-weight: 700;
    color: #b68c00;
    margin-bottom: 25px;
}

/* TABLE */
.table {
    width: 100%;
    table-layout: auto;
    border-collapse: separate;
    border-spacing: 0 10px;
}

.table thead {
    background: #b68c00;
    color: white;
}

.table thead th {
    padding: 14px 10px;
    font-size: 14px;
    font-weight: 600;
    white-space: nowrap;
}

.table tbody tr {
    background: #ffffff;
    border-radius: 10px;
    transition: 0.25s ease;
}

.table tbody tr:hover {
    background: rgba(0,0,0,0.05);
    transform: scale(1.01);
}

.table td {
    padding: 12px 10px !important;
    font-size: 14px;
    vertical-align: middle !important;
    white-space: nowrap;
}

/* STAFF BADGES */
.status-badge {
    padding: 6px 14px;
    border-radius: 10px;
    font-weight: 600;
    font-size: 13px;
    color: white;
}

.status-yes {
    background: #17863e;
}

.status-no {
    background: #c62828;
}

/* ACTION BUTTONS */
.action-btn {
    padding: 6px 14px;
    border: none;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    margin: 2px;
    min-width: 75px;
    display: inline-block;
}

.btn-edit {
    background: #f0b126;
    color: black;
}

.btn-edit:hover {
    background: #d99c1f;
}

.btn-delete {
    background: #d32f2f;
    color: white;
}

.btn-delete:hover {
    background: #b71c1c;
}

</style>


<div class="container">

    <div class="admin-wrapper">

        <h2 class="admin-title">Manage Users</h2>

        <div class="table-responsive">
            <table class="table align-middle text-center">

                <thead>
                    <tr>
                        <th>#</th>
                        <th>Full Name</th>
                        <th>Email</th>
                        <th>Username</th>
                        <th>Staff</th>
                        <th>Actions</th>
                    </tr>
                </thead>

                <tbody>
                    {% for user in users %}
                    <tr>

                        <td>{{ forloop.counter }}</td>

                        <!-- FULL NAME -->
                        <td>
                            {% if user.first_name or user.last_name %}
                                {{ user.first_name }} {{ user.last_name }}
                            {% else %}
                                {{ user.username }}
                            {% endif %}
                        </td>

                        <td>{{ user.email }}</td>
                        <td>{{ user.username }}</td>

                        <!-- STAFF BADGE -->
                        <td>
    {% if user.is_staff %}
        <span class="status-badge status-yes">Yes</span>
        <a href="{% url 'toggle_staff' user.id %}" class="action-btn btn-delete" 
           onclick="return confirm('Remove staff privilege?');">
           Remove
        </a>
    {% else %}
        <span class="status-badge status-no">No</span>
        <a href="{% url 'toggle_staff' user.id %}" class="action-btn btn-edit">
           Make Staff
        </a>
    {% endif %}
</td>

                        <!-- ACTION BUTTONS -->
                        <td>
                            <a href="{% url 'edit_user' user.id %}" class="action-btn btn-edit">Edit</a>

                            <a href="{% url 'delete_user' user.id %}"
                               onclick="return confirm('Are you sure you want to delete this user?');"
                               class="action-btn btn-delete">
                               Delete
                            </a>
                        </td>

                    </tr>
                    {% endfor %}
                </tbody>

            </table>
        </div>

    </div>

</div>

{% endblock %}
